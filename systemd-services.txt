# Einkaufsliste Systemd Services
# Backup-Services falls PM2 nicht verfügbar ist

# Frontend Service
# /etc/systemd/system/einkaufsliste-frontend.service
[Unit]
Description=Einkaufsliste Frontend
After=network.target

[Service]
Type=simple
User=einkaufsliste
WorkingDirectory=/home/einkaufsliste/einkaufsliste/frontend
ExecStart=/usr/bin/npm start
Restart=always
RestartSec=10
Environment=NODE_ENV=production
Environment=PORT=3000
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target

---

# Backend Service  
# /etc/systemd/system/einkaufsliste-backend.service
[Unit]
Description=Einkaufsliste Backend
After=network.target

[Service]
Type=simple
User=einkaufsliste
WorkingDirectory=/home/einkaufsliste/einkaufsliste/backend
ExecStart=/usr/bin/node server.js
Restart=always
RestartSec=10
Environment=NODE_ENV=production
Environment=PORT=4000
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target

---

# API Service
# /etc/systemd/system/einkaufsliste-api.service
[Unit]
Description=Einkaufsliste API
After=network.target

[Service]
Type=simple
User=einkaufsliste
WorkingDirectory=/home/einkaufsliste/einkaufsliste/api
ExecStart=/home/einkaufsliste/einkaufsliste/api/venv/bin/python admin_server.py
Restart=always
RestartSec=10
Environment=PYTHON_ENV=production
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target

---

# Webhook Service
# /etc/systemd/system/einkaufsliste-webhook.service
[Unit]
Description=Einkaufsliste Webhook Handler
After=network.target

[Service]
Type=simple
User=einkaufsliste
WorkingDirectory=/home/einkaufsliste
ExecStart=/usr/bin/python3 webhook.py
Restart=always
RestartSec=10
Environment=GITHUB_WEBHOOK_SECRET=einkaufsliste-webhook-secret
StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target

---

# Installation der Systemd Services (falls PM2 nicht gewünscht):

# sudo cp diese_datei_services/* /etc/systemd/system/
# sudo systemctl daemon-reload
# sudo systemctl enable einkaufsliste-frontend einkaufsliste-backend einkaufsliste-api einkaufsliste-webhook
# sudo systemctl start einkaufsliste-frontend einkaufsliste-backend einkaufsliste-api einkaufsliste-webhook

# Status prüfen:
# sudo systemctl status einkaufsliste-*

# Logs anzeigen:
# sudo journalctl -u einkaufsliste-frontend -f
# sudo journalctl -u einkaufsliste-backend -f
# sudo journalctl -u einkaufsliste-api -f
# sudo journalctl -u einkaufsliste-webhook -f
